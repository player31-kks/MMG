<Window x:Class="MMG.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MMG"
        xmlns:models="clr-namespace:MMG.Models"
        xmlns:api="clr-namespace:MMG.Views.API"
        xmlns:test="clr-namespace:MMG.Views.Test"
        xmlns:viewModels="clr-namespace:MMG.ViewModels"
        xmlns:specViewModels="clr-namespace:MMG.ViewModels.Spec"
        xmlns:spec="clr-namespace:MMG.Views.Spec"
        xmlns:converters="clr-namespace:MMG.Converters"
        mc:Ignorable="d"
        Title="MMG"
        Height="1000"
        Width="1600"
        MinHeight="600"
        MinWidth="1000"
        Background="{StaticResource SurfaceBackground}">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="35"
                      ResizeBorderThickness="5"
                      UseAeroCaptionButtons="False"/>
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <ResourceDictionary>
            <converters:StringToBooleanConverter x:Key="StringToBooleanConverter"/>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Resources/Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="35"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Custom Title Bar -->
        <Border Grid.Row="0"
                Background="{StaticResource PanelBackground}"
                BorderBrush="{StaticResource MutedBorder}"
                BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Title -->
                <TextBlock Grid.Column="0"
                           Text="MMG"
                           VerticalAlignment="Center"
                           Margin="10,0,0,0"
                           FontWeight="SemiBold"
                           FontSize="14"/>

                <!-- Settings Button -->
                <Button Grid.Column="1"
                        Content="★"
                        Width="35"
                        Height="35"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="16"
                        ToolTip="설정"
                        Click="SettingsButton_Click"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background"
                                    Value="Transparent"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#E9ECEF"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#DEE2E6"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>

                <!-- Minimize Button -->
                <Button Grid.Column="2"
                        Content="─"
                        Width="35"
                        Height="35"
                        Click="MinimizeButton_Click"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background"
                                    Value="Transparent"/>
                            <Setter Property="BorderThickness"
                                    Value="0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#E9ECEF"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#DEE2E6"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>

                <!-- Maximize/Restore Button -->
                <Button Grid.Column="3"
                        Content="□"
                        Width="35"
                        Height="35"
                        Click="MaximizeButton_Click"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background"
                                    Value="Transparent"/>
                            <Setter Property="BorderThickness"
                                    Value="0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#E9ECEF"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#DEE2E6"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>

                <!-- Close Button -->
                <Button Grid.Column="4"
                        Content="✕"
                        Width="35"
                        Height="35"
                        Click="CloseButton_Click"
                        WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background"
                                    Value="Transparent"/>
                            <Setter Property="BorderThickness"
                                    Value="0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#DC3545"/>
                                                <Setter Property="Foreground"
                                                        Value="White"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="#C82333"/>
                                                <Setter Property="Foreground"
                                                        Value="White"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1"
              Background="{StaticResource SurfaceBackground}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Sidebar with Icons -->
            <Border Grid.Column="0"
                    Background="#F3F4F8"
                    BorderBrush="{StaticResource MutedBorder}"
                    BorderThickness="0,0,1,0">
                <StackPanel Orientation="Vertical"
                            Margin="0,18,0,0">

                    <!-- APIs Tab -->
                    <ToggleButton x:Name="ApiTabButton"
                                  Width="56"
                                  Height="56"
                                  Margin="6,6,6,16"
                                  IsChecked="{Binding SelectedTab, Converter={StaticResource StringToBooleanConverter}, ConverterParameter=API}"
                                  Command="{Binding ApiTabCommand}"
                                  Style="{StaticResource SidebarTabStyle}"
                                  ToolTip="APIs">
                        <StackPanel Orientation="Vertical">
                            <Viewbox Width="20"
                                     Height="20">
                                <Canvas Width="24"
                                        Height="24">
                                    <Path Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"
                                          Fill="{Binding RelativeSource={RelativeSource AncestorType=ToggleButton}, Path=Foreground}"/>
                                </Canvas>
                            </Viewbox>
                            <TextBlock Text="APIs"
                                       FontSize="10"
                                       HorizontalAlignment="Center"
                                       Margin="0,2,0,0"/>
                        </StackPanel>
                    </ToggleButton>

                    <!-- Tests Tab -->
                    <ToggleButton x:Name="TestsTabButton"
                                  Width="56"
                                  Height="56"
                                  Margin="6,0,6,16"
                                  IsChecked="{Binding SelectedTab, Converter={StaticResource StringToBooleanConverter}, ConverterParameter=Tests}"
                                  Command="{Binding TestsTabCommand}"
                                  Style="{StaticResource SidebarTabStyle}"
                                  ToolTip="Tests">
                        <StackPanel Orientation="Vertical">
                            <Viewbox Width="20"
                                     Height="20">
                                <Canvas Width="24"
                                        Height="24">
                                    <Path Data="M12,2C13.1,2 14,2.9 14,4C14,5.1 13.1,6 12,6C10.9,6 10,5.1 10,4C10,2.9 10.9,2 12,2M21,9V7L15,1H5C3.89,1 3,1.89 3,3V21A2,2 0 0,0 5,23H19A2,2 0 0,0 21,21V9M19,9H14V4H19M12,19L8,14.5L9.5,13L12,15.5L18.5,9L20,10.5L12,19Z"
                                          Fill="{Binding RelativeSource={RelativeSource AncestorType=ToggleButton}, Path=Foreground}"/>
                                </Canvas>
                            </Viewbox>
                            <TextBlock Text="Tests"
                                       FontSize="10"
                                       HorizontalAlignment="Center"
                                       Margin="0,2,0,0"/>
                        </StackPanel>
                    </ToggleButton>

                    <!-- Spec Tab -->
                    <ToggleButton x:Name="SpecTabButton"
                                  Width="56"
                                  Height="56"
                                  Margin="6,0,6,16"
                                  IsChecked="{Binding SelectedTab, Converter={StaticResource StringToBooleanConverter}, ConverterParameter=Spec}"
                                  Command="{Binding SpecTabCommand}"
                                  Style="{StaticResource SidebarTabStyle}"
                                  ToolTip="Spec">
                        <StackPanel Orientation="Vertical">
                            <Viewbox Width="20"
                                     Height="20">
                                <Canvas Width="24"
                                        Height="24">
                                    <Path Data="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M9,13V19H7V13H9M15,15V19H17V15H15M11,11V19H13V11H11Z"
                                          Fill="{Binding RelativeSource={RelativeSource AncestorType=ToggleButton}, Path=Foreground}"/>
                                </Canvas>
                            </Viewbox>
                            <TextBlock Text="Spec"
                                       FontSize="10"
                                       HorizontalAlignment="Center"
                                       Margin="0,2,0,0"/>
                        </StackPanel>
                    </ToggleButton>

                </StackPanel>
            </Border>

            <!-- Main Content Area -->
            <Border Grid.Column="1"
                    Background="{StaticResource SurfaceBackground}">
                <ContentPresenter Content="{Binding CurrentContent}">
                    <ContentPresenter.Resources>
                        <!-- API Content Template -->
                        <DataTemplate DataType="{x:Type viewModels:MainViewModel}">
                            <api:ApiContentPanel/>
                        </DataTemplate>

                        <!-- Tests Content Template -->
                        <DataTemplate DataType="{x:Type viewModels:TestsViewModel}">
                            <test:TestsContentPanel/>
                        </DataTemplate>

                        <!-- Spec Content Template -->
                        <DataTemplate DataType="{x:Type specViewModels:SpecViewModel}">
                            <spec:SpecContentPanel/>
                        </DataTemplate>
                    </ContentPresenter.Resources>
                </ContentPresenter>
            </Border>
        </Grid>
    </Grid>
</Window>
